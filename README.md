# 智能考勤系统 - 后端服务

本项目是智能考勤系统的后端服务，基于Spring Boot 3.x开发，提供完整的考勤管理功能API。

## 项目架构

项目采用了分层架构设计：

- **控制器层**：接收请求，参数校验，调用服务，封装响应
- **服务层**：业务逻辑处理，事务管理，领域规则实现
- **仓库层**：数据访问，ORM映射，持久化操作
- **数据层**：基于MySQL的数据存储

## 项目结构

```
com.attendance
├── controller/          # 所有控制器
│   ├── auth/            # 认证相关控制器
│   ├── user/            # 用户相关控制器
│   ├── task/            # 任务相关控制器
│   └── record/          # 签到记录相关控制器
├── service/             # 所有服务
│   ├── auth/            # 认证相关服务
│   ├── user/            # 用户相关服务
│   ├── task/            # 任务相关服务
│   └── record/          # 签到记录相关服务
├── repository/          # 所有数据访问
│   ├── user/            # 用户相关存储库
│   ├── task/            # 任务相关存储库
│   └── record/          # 签到记录相关存储库
├── model/               # 所有数据模型
│   ├── entity/          # 实体类
│   ├── dto/             # 数据传输对象
│   └── vo/              # 视图对象
├── common/              # 通用组件
│   ├── config/          # 配置类
│   │   ├── security/    # 安全配置
│   │   ├── redis/       # Redis配置
│   │   └── web/         # Web相关配置
│   ├── exception/       # 异常处理
│   ├── util/            # 工具类
│   └── constants/       # 常量定义
└── AttendanceApplication.java  # 应用入口
```

## 技术栈

- **核心框架**：Spring Boot 3.x
- **安全框架**：Spring Security + JWT
- **数据访问**：Spring Data JPA
- **数据存储**：MySQL + Redis
- **API规范**：RESTful API
- **参数校验**：Jakarta Bean Validation
- **日志框架**：SLF4J + Logback
- **工具库**：Lombok, MapStruct, Guava

## 开发环境搭建

### 前置要求

- JDK 17+
- Maven 3.8+
- MySQL 8.0+
- Redis 6.0+

### 启动步骤

1. 克隆项目
   ```
   git clone https://github.com/yourusername/attendance-backend.git
   ```

2. 配置数据库
   - 修改 `src/main/resources/application.yml` 中的数据库连接参数

3. 编译项目
   ```
   mvn clean package
   ```

4. 运行项目
   ```
   java -jar target/attendance-service-0.0.1-SNAPSHOT.jar
   ```

## API文档

启动项目后，访问 Swagger 文档：

```
http://localhost:8080/swagger-ui.html
```

## 开发规范

1. **命名规范**：
   - 类名：大驼峰（如 UserController）
   - 方法名：小驼峰（如 getUserById）
   - 变量名：小驼峰（如 userName）
   - 常量名：全大写下划线分隔（如 MAX_COUNT）

2. **注释规范**：
   - 类注释：描述类的功能和用途
   - 方法注释：描述方法的功能、参数和返回值
   - 重要代码注释：解释复杂逻辑

3. **代码提交规范**：
   - 提交前执行测试确保通过
   - 提交信息格式：`[模块名] 操作描述`（如：`[Auth] 修复登录验证bug`）

## 参考文档

详细设计文档请参考 `docs/设计文档.md`。

## 一、后端架构设计

### 1.1 架构概述

智能考勤系统后端采用分层架构设计，基于Spring Boot框架实现，各层职责清晰，便于维护与扩展：

```
┌───────────────────────────────────────────────────────┐
│                   Controller Layer                    │
│        (接收请求，参数校验，调用服务，封装响应)          │
└───────────────────────────┬───────────────────────────┘
                            │
┌───────────────────────────┼───────────────────────────┐
│                   Service Layer                       │
│        (业务逻辑处理，事务管理，领域规则实现)            │
└───────────────────────────┬───────────────────────────┘
                            │
┌───────────────────────────┼───────────────────────────┐
│                 Repository Layer                      │
│            (数据访问，ORM映射，持久化操作)              │
└───────────────────────────┬───────────────────────────┘
                            │
┌───────────────────────────┼───────────────────────────┐
│                       Database                        │
│                       (数据存储)                       │
└───────────────────────────────────────────────────────┘
```

### 1.2 技术栈选型

- **核心框架**：Spring Boot 3.x
- **安全框架**：Spring Security + JWT
- **数据访问**：Spring Data JPA
- **数据存储**：MySQL + Redis
- **API规范**：RESTful API
- **参数校验**：Jakarta Bean Validation
- **日志框架**：SLF4J + Logback
- **工具库**：
  - Lombok (简化代码)
  - MapStruct (对象映射)
  - Guava (通用工具)

### 1.3 包结构设计

```
com.attendance
├── controller/          # 所有控制器
│   ├── auth/            # 认证相关控制器
│   ├── user/            # 用户相关控制器
│   ├── task/            # 任务相关控制器
│   └── record/          # 签到记录相关控制器
├── service/             # 所有服务
│   ├── auth/            # 认证相关服务
│   ├── user/            # 用户相关服务
│   ├── task/            # 任务相关服务
│   └── record/          # 签到记录相关服务
├── repository/          # 所有数据访问
│   ├── user/            # 用户相关存储库
│   ├── task/            # 任务相关存储库
│   └── record/          # 签到记录相关存储库
├── model/               # 所有数据模型
│   ├── entity/          # 实体类
│   ├── dto/             # 数据传输对象
│   └── vo/              # 视图对象
├── common/              # 通用组件
│   ├── config/          # 配置类
│   │   ├── security/    # 安全配置
│   │   ├── redis/       # Redis配置
│   │   └── web/         # Web相关配置
│   ├── exception/       # 异常处理
│   ├── util/            # 工具类
│   └── constants/       # 常量定义
└── AttendanceApplication.java  # 应用入口
```

### 1.4 核心组件设计

#### 1.4.1 全局响应处理

统一的响应结构设计，确保API返回格式一致：

- **标准响应字段**：状态码、消息、数据
- **成功响应**：包含状态码200及业务数据
- **错误响应**：包含错误码及错误详情
- **分页响应**：包含分页信息及列表数据

#### 1.4.2 全局异常处理

统一的异常处理机制，将各类异常转换为规范的API响应：

- **业务异常**：处理业务规则验证失败
- **资源未找到异常**：处理请求的资源不存在
- **参数验证异常**：处理请求参数格式错误
- **认证授权异常**：处理权限不足或未认证
- **系统异常**：处理未预期的系统错误

#### 1.4.3 安全配置

基于Spring Security的认证授权机制：

- **无状态设计**：基于JWT的无状态认证
- **权限控制**：基于角色的访问控制（RBAC）
- **请求过滤**：JWT认证过滤器校验令牌
- **资源保护**：API资源按角色划分权限
- **密码加密**：BCrypt加密保护用户密码

#### 1.4.4 Redis缓存配置

使用Redis进行缓存和会话管理：

- **数据缓存**：减少数据库压力，提高响应速度
- **会话存储**：存储用户会话和认证信息
- **分布式锁**：处理并发问题和竞态条件
- **缓存策略**：设置合理的过期时间和淘汰策略
- **序列化配置**：JSON序列化实现对象存储

## 二、数据模型设计

### 2.1 实体关系图

```
┌───────────────┐       ┌───────────────┐       ┌───────────────┐
│     User      │       │     Task      │       │    Record     │
├───────────────┤       ├───────────────┤       ├───────────────┤
│ id            │       │ id            │       │ userId        │
│ username      │       │ title         │       │ taskId        │
│ password      │       │ description   │       │ status        │
│ fullName      │◄──────┤ creatorId     │       │ checkInTime   │
│ email         │       │ startTime     │◄──────┤ location      │
│ role          │       │ endTime       │       │ device        │
│ enabled       │       │ status        │       │ verifyMethod  │
│ createdAt     │       │ checkInType   │       │ verifyData    │
│ updatedAt     │       │ verifyParams  │       │ verifyData    │
└───────────────┘       └───────────────┘       └───────────────┘


┌───────────────┐       ┌───────────────┐
│    Course     │       │ Course_User   │
├───────────────┤       ├───────────────┤
│ id            │       │ id            │
│ name          │       │ courseId      │
│ description   │◄──────┤ userId        │
│ creatorId     │       │ role          │
│ code          │       │ joinedAt      │
│ startDate     │       └───────────────┘
│ endDate       │
│ status        │       ┌───────────────┐
│ createdAt     │       │     Task      │
│ updatedAt     │       ├───────────────┤
└───────┬───────┘       │ id            │
        │               │ courseId      │◄─┐
        └───────────────▶ title         │  │
                        │ description   │  │
                        │ ...           │  │
                        └───────────────┘  │
                                           │
┌───────────────┐                          │
│     User      │                          │
├───────────────┤                          │
│ id            │                          │
│ username      │◄─────────────────────────┘
│ ...           │
└───────────────┘
```

### 2.2 课程与群组设计

系统采用课程作为群组单位，实现了图结构的设计模式：

#### 课程群组模型

- **Course（课程）**：代表一个教学单位，由老师创建
- **User（用户）**：可以是教师或学生
- **Course_User（课程-用户关系）**：表示用户与课程的多对多关系
- **Task（签到任务）**：归属于特定课程，只对课程内的学生可见

#### 群组关系流程

1. **课程创建**：
   - 教师创建课程，设置课程名称、描述等信息
   - 系统自动生成唯一的课程邀请码
   - 创建者自动成为课程管理员

2. **学生加入**：
   - 学生通过课程邀请码申请加入
   - 老师通过学号/邮箱批量导入学生
   - 老师直接向学生发送邀请链接

3. **签到任务发布**：
   - 老师在课程内创建签到任务
   - 任务自动关联到该课程
   - 只有课程内的学生能看到并参与签到

4. **权限控制**：
   - 课程创建者（老师）拥有管理权限
   - 普通成员（学生）拥有参与权限
   - 系统管理员拥有全局权限

#### 技术实现

课程群组采用了图数据结构：
- 节点：用户(User)和课程(Course)
- 边：用户与课程的关系(Course_User)
- 属性：关系类型(role)、加入时间等

这种设计允许：
- 一个学生可以加入多个课程
- 一个老师可以管理多个课程
- 一个课程可以关联多个签到任务
- 隔离不同课程的签到任务和学生

通过这种图结构，系统能够有效管理复杂的教学组织结构，确保签到任务仅对相关学生可见，提高系统的安全性和针对性。

### 2.3 实体设计

#### 2.3.1 用户实体 (User)

**核心属性**：
- 用户ID（主键）
- 用户名（唯一标识）
- 密码（加密存储）
- 姓名
- 邮箱
- 角色（学生、教师、系统管理员）
- 账户状态
- 创建时间
- 更新时间

**业务规则**：
- 用户名全局唯一
- 密码必须加密存储
- 用户角色决定权限范围
- 创建和更新时间自动设置

#### 2.3.2 签到任务实体 (Task)

**核心属性**：
- 任务ID（主键）
- 任务标题
- 任务描述
- 创建者ID（关联用户）
- 开始时间
- 结束时间
- 任务状态（创建、进行中、已结束）
- 签到类型（二维码、位置、WiFi、手动）
- 验证参数（根据签到类型存储相关信息）

**业务规则**：
- 只有教师和管理员可以创建任务
- 任务状态随时间自动变化
- 任务结束后不可再签到
- 验证参数格式由签到类型决定

#### 2.3.3 签到记录实体 (Record)

**核心属性**：
- 记录ID（主键）
- 用户ID（关联用户）
- 任务ID（关联任务）
- 签到状态（正常、迟到、缺席）
- 签到时间
- 签到位置
- 设备信息
- 验证方式
- 验证数据

**业务规则**：
- 每个用户对每个任务只能有一条签到记录
- 签到状态根据任务时间自动判定
- 验证数据需与任务设置的验证要求匹配
- 记录签到设备信息用于异常分析

### 2.4 DTO设计

#### 2.4.1 请求DTO

- **用户认证请求**：用户名和密码
- **任务创建请求**：任务标题、描述、时间、签到类型等
- **签到请求**：任务ID、验证数据、位置信息等

#### 2.4.2 响应DTO

- **用户信息响应**：不含敏感数据的用户信息
- **任务详情响应**：包含创建者信息的任务详情
- **签到记录响应**：包含用户和任务信息的签到记录
- **统计数据响应**：签到率、出勤状况等统计信息

### 2.5 VO设计

- **用户视图对象**：前端展示的用户信息
- **任务视图对象**：前端展示的任务信息
- **记录视图对象**：前端展示的签到记录信息
- **统计视图对象**：前端展示的统计结果信息

## 三、业务逻辑设计

### 3.1 用户认证与授权流程

```
┌───────────┐     ┌───────────┐     ┌───────────┐     ┌───────────┐
│  客户端   │     │ 控制器层  │     │  服务层   │     │ 数据访问层 │
└─────┬─────┘     └─────┬─────┘     └─────┬─────┘     └─────┬─────┘
      │                 │                 │                 │
      │  登录请求       │                 │                 │
      │────────────────>│                 │                 │
      │                 │                 │                 │
      │                 │  验证用户凭证   │                 │
      │                 │────────────────>│                 │
      │                 │                 │                 │
      │                 │                 │  查询用户信息   │
      │                 │                 │────────────────>│
      │                 │                 │                 │
      │                 │                 │  返回用户数据   │
      │                 │                 │<────────────────│
      │                 │                 │                 │
      │                 │                 │  验证密码       │
      │                 │                 │<────────────────│
      │                 │                 │                 │
      │                 │  生成JWT令牌    │                 │
      │                 │<────────────────│                 │
      │                 │                 │                 │
      │  返回令牌       │                 │                 │
      │<────────────────│                 │                 │
      │                 │                 │                 │
```

认证流程设计：

1. **登录请求处理**：
   - 接收用户名和密码
   - 验证用户凭证有效性
   - 生成JWT令牌
   - 返回令牌及用户基本信息

2. **令牌验证流程**：
   - 提取请求头中的令牌
   - 验证令牌签名和有效期
   - 解析用户身份和权限
   - 构建安全上下文

3. **权限控制策略**：
   - 学生：只能访问自己的签到记录
   - 教师：可以管理任务和查看相关签到记录
   - 管理员：拥有系统所有权限

### 3.2 签到任务管理流程

```
┌────────────────┐     ┌────────────────┐     ┌────────────────┐
│     创建阶段    │     │     活跃阶段    │     │     完成阶段    │
└────────┬───────┘     └────────┬───────┘     └────────┬───────┘
         │                      │                      │
         │ 教师创建任务          │                      │
         │                      │                      │
         │ 设置验证方式          │                      │
         │                      │                      │
         │ 指定起止时间          │                      │
         │                      │                      │
         └──────────────────────┘                      │
                      │                                │
                      │ 学生签到                       │
                      │                                │
                      │ 验证签到数据                   │
                      │                                │
                      │ 记录签到状态                   │
                      │                                │
                      └────────────────────────────────┘
                                     │
                                     │ 统计签到情况
                                     │
                                     │ 生成报表数据
                                     │
                                     │ 归档任务
                                     │
                                     ▼
```

任务管理流程设计：

1. **任务创建流程**：
   - 教师创建签到任务
   - 设置任务基本信息
   - 选择签到类型和验证规则
   - 设置起止时间
   - 保存并发布任务

2. **任务状态管理**：
   - 创建状态：任务已创建但未开始
   - 活跃状态：任务进行中，可以签到
   - 完成状态：任务已结束，不可签到
   - 状态自动流转：根据任务时间自动更新

3. **任务查询和筛选**：
   - 按创建者筛选
   - 按状态筛选
   - 按时间范围筛选
   - 按关键词搜索

### 3.3 签到验证流程

```
┌───────────────────────────────────────────────────────┐
│                    验证方式选择                        │
└────────┬──────────────┬─────────────┬─────────────────┘
         │              │             │                 
┌────────▼─────┐ ┌──────▼───────┐ ┌───▼──────────┐ ┌────▼───────────┐
│  二维码签到   │ │   位置签到   │ │   WiFi签到   │ │   手动签到     │
└──────────────┘ └──────────────┘ └──────────────┘ └────────────────┘
│                │                │                │                 
│ 生成签到码     │ 设置签到范围   │ 设置WiFi信息   │ 教师选择学生    
│                │                │                │                 
│ 学生扫描       │ 获取学生位置   │ 获取连接信息   │ 批量添加记录    
│                │                │                │                 
│ 验证有效性     │ 计算位置偏差   │ 比对WiFi参数   │ 设置签到状态    
│                │                │                │                 
└────────────────┴────────────────┴────────────────┴─────────────────┘
                                   │                                 
                           ┌───────▼──────────┐                      
                           │    验证结果      │                      
                           └───────┬──────────┘                      
                                   │                                 
                    ┌──────────────┴──────────────┐                  
                    │                             │                  
              ┌─────▼─────┐                 ┌─────▼─────┐            
              │  验证通过  │                 │  验证失败  │            
              └─────┬─────┘                 └─────┬─────┘            
                    │                             │                  
              ┌─────▼─────┐                 ┌─────▼─────┐            
              │ 记录签到   │                 │ 提示错误   │            
              └───────────┘                 └───────────┘            
```

签到验证流程设计：

1. **二维码签到流程**：
   - 系统生成包含签到信息的二维码
   - 学生扫描二维码获取签到数据
   - 验证二维码有效性和时效性
   - 记录签到状态和时间

2. **位置签到流程**：
   - 教师设置有效签到范围
   - 学生提交当前位置信息
   - 系统计算位置偏差是否在允许范围内
   - 通过位置验证后记录签到

3. **WiFi签到流程**：
   - 教师设置指定WiFi信息
   - 学生提交当前连接的WiFi信息
   - 验证学生WiFi信息与指定信息是否匹配
   - 匹配成功后记录签到

4. **手动签到流程**：
   - 教师查看学生列表
   - 选择需要标记的学生
   - 设置签到状态（正常、迟到、缺席）
   - 提交批量签到记录

### 3.4 数据统计分析流程

```
┌───────────────┐       ┌───────────────┐       ┌───────────────┐
│  原始签到数据  │       │  数据聚合处理  │       │  统计结果展示  │
└───────┬───────┘       └───────┬───────┘       └───────┬───────┘
        │                       │                       │
        │  收集签到记录          │                       │
        │────────────────────────                       │
        │                       │                       │
        │  分类整理数据          │                       │
        │────────────────────────                       │
        │                       │                       │
        │                       │  按任务统计           │
        │                       │───────────────────────│
        │                       │                       │
        │                       │  按用户统计           │
        │                       │───────────────────────│
        │                       │                       │
        │                       │  按时间段统计         │
        │                       │───────────────────────│
        │                       │                       │
        │                       │                       │  生成图表
        │                       │                       │───────────
        │                       │                       │
        │                       │                       │  导出报表
        │                       │                       │───────────
```

数据统计分析流程设计：

1. **数据收集**：
   - 获取指定范围内的签到记录
   - 按不同维度分类整理数据
   - 准备用于统计分析的数据集

2. **统计计算**：
   - 任务维度：出勤率、迟到率、缺席率
   - 用户维度：个人出勤情况、异常记录
   - 时间维度：不同时间段的签到趋势
   - 多维分析：交叉对比不同维度数据

3. **结果展示**：
   - 数据可视化：图表、仪表盘
   - 数据导出：Excel、PDF报表
   - 异常提醒：识别并标记异常签到模式

## 四、接口设计

### 4.1 RESTful API设计规范

API设计遵循RESTful风格，具有以下特点：

- **资源导向**：API围绕资源设计，使用名词表示资源
- **HTTP方法语义**：
  - GET：获取资源
  - POST：创建资源
  - PUT：完全更新资源
  - PATCH：部分更新资源
  - DELETE：删除资源
- **状态码使用**：
  - 2xx：成功响应
  - 4xx：客户端错误
  - 5xx：服务端错误
- **版本控制**：通过URL路径控制API版本
- **分页机制**：支持limit/offset或页码/页大小分页
- **过滤和排序**：通过查询参数实现过滤和排序
- **HATEOAS**：在响应中包含相关资源链接

### 4.2 核心接口定义

#### 4.2.1 认证接口

| 接口名称 | 路径 | 方法 | 请求参数 | 响应内容 | 说明 |
|---------|------|-----|---------|---------|-----|
| 用户登录 | /api/auth/login | POST | 用户名、密码 | JWT令牌和用户信息 | 身份验证并生成令牌 |
| 刷新令牌 | /api/auth/refresh | POST | 刷新令牌 | 新的访问令牌 | 在访问令牌过期后获取新令牌 |
| 用户注销 | /api/auth/logout | POST | 当前令牌 | 注销状态 | 使当前令牌失效 |

#### 4.2.2 用户管理接口

| 接口名称 | 路径 | 方法 | 请求参数 | 响应内容 | 说明 |
|---------|------|-----|---------|---------|-----|
| 获取用户信息 | /api/users/{id} | GET | 用户ID(路径参数) | 用户详情 | 获取指定用户的完整信息 |
| 更新用户信息 | /api/users/{id} | PUT/PATCH | 用户ID(路径参数)、更新的用户信息 | 更新后的用户信息 | 完整或部分更新用户资料 |
| 查询用户列表 | /api/users | GET | 分页参数、筛选条件、排序字段 | 用户列表和分页信息 | 支持多条件筛选和分页查询 |

#### 4.2.3 任务管理接口

| 接口名称 | 路径 | 方法 | 请求参数 | 响应内容 | 说明 |
|---------|------|-----|---------|---------|-----|
| 创建任务 | /api/tasks | POST | 任务详情(标题、描述、时间等) | 创建的任务信息 | 创建新的签到任务 |
| 获取任务详情 | /api/tasks/{id} | GET | 任务ID(路径参数) | 任务完整信息 | 包括任务状态和签到统计 |
| 更新任务 | /api/tasks/{id} | PUT/PATCH | 任务ID(路径参数)、更新的任务信息 | 更新后的任务信息 | 修改任务属性 |
| 删除任务 | /api/tasks/{id} | DELETE | 任务ID(路径参数) | 删除状态 | 逻辑删除签到任务 |
| 查询任务列表 | /api/tasks | GET | 分页参数、状态筛选、时间范围 | 任务列表和分页信息 | 支持按状态和时间筛选 |

#### 4.2.4 签到记录接口

| 接口名称 | 路径 | 方法 | 请求参数 | 响应内容 | 说明 |
|---------|------|-----|---------|---------|-----|
| 提交签到 | /api/records | POST | 任务ID、签到方式、验证数据 | 签到结果和状态 | 学生提交签到信息 |
| 查询签到记录 | /api/records | GET | 任务ID、用户ID、签到状态 | 签到记录列表 | 支持多条件筛选 |
| 更新签到状态 | /api/records/{id} | PATCH | 记录ID(路径参数)、新状态 | 更新后的签到记录 | 修改签到状态(如补签) |
| 批量签到操作 | /api/records/batch | POST | 批量签到数据(学生列表、任务ID) | 批量处理结果 | 教师批量操作学生签到 |

#### 4.2.5 统计分析接口

| 接口名称 | 路径 | 方法 | 请求参数 | 响应内容 | 说明 |
|---------|------|-----|---------|---------|-----|
| 任务签到统计 | /api/statistics/tasks/{id} | GET | 任务ID(路径参数) | 任务签到统计数据 | 包括出勤率、迟到率等 |
| 用户签到统计 | /api/statistics/users/{id} | GET | 用户ID(路径参数)、时间范围 | 用户签到统计数据 | 个人出勤情况分析 |
| 时间段统计 | /api/statistics/period | GET | 开始时间、结束时间 | 时间段内的统计数据 | 时段内的签到趋势分析 |
| 数据导出 | /api/statistics/export | POST | 导出条件、格式选择 | 文件下载链接 | 支持Excel、PDF格式导出 |

## 五、性能与安全设计

### 5.1 性能优化策略

1. **数据库优化**：
   - 合理索引设计：主键、外键、常用查询字段
   - 查询优化：避免全表扫描，使用索引查询
   - 连接池管理：合理设置连接数和超时

2. **缓存策略**：
   - 多级缓存：本地缓存、Redis分布式缓存
   - 热点数据缓存：用户信息、任务信息、统计数据
   - 缓存更新策略：定时刷新、主动失效

3. **并发处理**：
   - 乐观锁：处理数据更新冲突
   - 分布式锁：处理跨节点并发
   - 异步处理：非关键操作异步执行

4. **数据库负载优化**：
   - 读写分离：主库写入，从库读取
   - 分库分表：大数据量场景下的水平拆分
   - 批量操作：减少数据库交互次数

### 5.2 安全防护策略

1. **接口安全**：
   - 参数验证：过滤非法输入
   - 防重放攻击：请求签名和时间戳验证
   - 防SQL注入：使用参数化查询
   - 防XSS攻击：输入输出转义

2. **认证与授权**：
   - 密码安全：加密存储，定期修改
   - JWT安全：签名验证，适当过期时间
   - 敏感操作二次验证
   - 最小权限原则

3. **数据安全**：
   - 敏感数据加密存储
   - 传输加密：HTTPS
   - 数据脱敏：隐藏敏感信息
   - 数据备份与恢复

4. **审计与监控**：
   - 操作日志记录
   - 异常行为监测
   - 安全事件响应机制
   - 定期安全审计

## 六、部署与运维设计

### 6.1 部署架构

```
┌─────────────────────────────────────────────────────────┐
│                     负载均衡 (Nginx)                      │
└───────────────────────────┬─────────────────────────────┘
                            │
      ┌─────────────────────┼─────────────────────┐
      │                     │                     │
┌─────▼─────┐         ┌─────▼─────┐         ┌─────▼─────┐
│ 应用节点1  │         │ 应用节点2  │         │ 应用节点3  │
└─────┬─────┘         └─────┬─────┘         └─────┬─────┘
      │                     │                     │
      └─────────────────────┼─────────────────────┘
                            │
┌─────────────────┐   ┌─────▼─────┐   ┌─────────────────┐
│  Redis集群      │◄──┤ 主从复制  ├──►│  MySQL集群      │
│  (缓存/会话)    │   │           │   │  (数据存储)     │
└─────────────────┘   └───────────┘   └─────────────────┘
```

### 6.2 容器化部署

1. **Docker容器**：
   - 应用服务容器
   - MySQL容器
   - Redis容器
   - Nginx容器

2. **Docker Compose配置**：
   - 服务编排
   - 环境变量管理
   - 容器间网络配置
   - 数据卷挂载

3. **Kubernetes部署**（可选）：
   - Pod设计
   - Service暴露
   - ConfigMap配置
   - StatefulSet持久化服务

### 6.3 监控与运维

1. **健康检查**：
   - 应用健康探针
   - 数据库连接监测
   - 缓存服务监测

2. **日志管理**：
   - 集中式日志收集
   - 日志分析
   - 异常告警

3. **性能监控**：
   - JVM监控
   - 数据库监控
   - 接口响应时间监控
   - 资源使用监控

4. **自动扩展**：
   - 负载自动扩展
   - 定时扩展策略
   - 容量规划

## 七、扩展与演进

### 7.1 短期优化计划

1. **性能优化**：
   - 热点数据缓存策略调整
   - 数据库查询优化
   - API响应时间优化

2. **功能完善**：
   - 丰富签到验证方式
   - 完善统计分析功能
   - 优化用户体验

3. **质量提升**：
   - 单元测试覆盖率提高
   - 系统集成测试
   - 安全漏洞扫描与修复

### 7.2 长期演进规划

1. **架构升级**：
   - 微服务架构改造
   - 消息队列引入
   - 分布式事务支持

2. **功能扩展**：
   - 教务系统集成：自动获取课程和学生信息
   - 多教师协作功能：支持教师团队管理课程签到
   - 高级数据分析：引入AI分析考勤行为模式
   - 移动端API优化：提供更丰富的移动端功能

3. **技术栈更新**：
   - 跟进Spring生态更新
   - 引入新的存储技术
   - 探索云原生架构 